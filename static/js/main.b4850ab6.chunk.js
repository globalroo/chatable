(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{101:function(t,e,n){},176:function(t,e,n){},178:function(t,e,n){},180:function(t,e,n){"use strict";n.r(e);var a=n(0),r=n.n(a),o=n(18),l=n.n(o),c=(n(101),n(57)),i=n.n(c),u=n(93),s=n(79),m=n(24),d=n(20),p=n(23),g=n(92),v=n(26),f=n(3),E=n(90),h=n(91),b=n(12),w=n(83),y=n(80),O=null,j=function(t){var e=t.token;return O=e},k=Object(y.a)(function(t,e){var n=e.headers,a=O;return{headers:Object(g.a)({},n,{authorization:a?"Bearer ".concat(a):""})}}),S=Object(b.d)(function(t){var e=t.query,n=Object(f.k)(e),a=n.kind,r=n.operation;return"OperationDefinition"===a&&"subscription"===r},new w.a({uri:"wss://subscriptions.graph.cool/v1/cjhdp4tzl2r890195ggdfyv2h",options:{reconnect:!0}}),new E.a({uri:"https://api.graph.cool/simple/v1/cjhdp4tzl2r890195ggdfyv2h"})),$=new v.a({link:k.concat(S),cache:new h.a}),C=n(181),I=n(185),N=n(182),x=n(184),G=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=Object(a.useState)(t),n=Object(m.a)(e,2),r=n[0],o=n[1];return{value:r,onChange:function(t){return o(t.target.value)}}},L=function(t){var e=t.handleLogin,n=Object(a.useState)(!0),o=Object(m.a)(n,2),l=o[0],c=o[1],i=G(),u=G(),s=G();return r.a.createElement(C.a.Dialog,null,r.a.createElement(C.a.Body,null,r.a.createElement("div",{className:"login-logo-container"},r.a.createElement("h1",null,"Chatable"),r.a.createElement("h5",null,"Create a user or use 'test/test' for signin")),r.a.createElement("div",{className:"login-title-container"},r.a.createElement("span",{className:"login-title-text"},l?"Login":"Sign Up")),r.a.createElement(I.a,null,!l&&r.a.createElement(N.a,Object.assign({autoFocus:!0,type:"text",placeholder:"Your name (to be used in chat)"},u)),r.a.createElement(N.a,Object.assign({autoFocus:!0,type:"email",placeholder:"Email"},i)),r.a.createElement(N.a,Object.assign({type:"password",placeholder:"Password"},s))),r.a.createElement(I.a,null,r.a.createElement(x.a,{className:"pointer",onClick:function(){return c(!l)}},l?"Don't have an account? Sign up":"Have an account? Log in"),r.a.createElement(x.a,{className:"pull-right pointer",onClick:function(){return e({name:u.value,email:i.value,password:s.value})}},l?"Login":"Create User"))))},D=n(21),U=n.n(D);n(176);function B(){var t=Object(d.a)(["\n\t{\n\t\tallGroups(orderBy: name_ASC) {\n\t\t\tid\n\t\t\tname\n\t\t\tdescription\n\t\t}\n\t}\n"]);return B=function(){return t},t}var F=U()(B()),J=function(t){var e=t.group;return r.a.createElement(p.c,{query:F},function(t){var n=t.loading,a=t.error,o=t.data;return n?r.a.createElement("p",null,"Loading..."):a?r.a.createElement("p",null,"Error :( ",JSON.stringify(a)):r.a.createElement("ul",{style:{color:"white"}},o.allGroups.map(function(t,n){var a=t.id===e.id,o="groupSelector_".concat(t.id);return r.a.createElement("li",{key:o,"data-testid":o},t.name," ",r.a.createElement("br",null),"[",t.id,"]",r.a.createElement("br",null),a?"Current Group":"")}))})},q=n(183);function A(){var t=Object(d.a)(["\n\tmutation createGroupChatEntry($fromId: ID!, $content: String!, $groupId: ID!) {\n\t\tcreateGroupChatEntry(fromId: $fromId, content: $content, groupId: $groupId) {\n\t\t\tcontent\n\t\t\tfrom {\n\t\t\t\tname\n\t\t\t\tid\n\t\t\t}\n\t\t\tgroup {\n\t\t\t\tid\n\t\t\t}\n\t\t\tid\n\t\t\tcreatedAt\n\t\t}\n\t}\n"]);return A=function(){return t},t}var z=U()(A()),P=function(t){var e,n=t.user,a=t.group,o=t.createGroupChatEntry;return r.a.createElement("div",null,r.a.createElement("form",{onSubmit:function(t){t.preventDefault(),e.value.length>0&&(o({variables:{fromId:n.id,content:e.value,groupId:a.id}}),e.value="")}},r.a.createElement(I.a,null,r.a.createElement(q.a,null,r.a.createElement(N.a,{type:"text",placeholder:"Type to talk...",autoFocus:!0,inputRef:function(t){e=t}}),r.a.createElement(q.a.Button,null,r.a.createElement(x.a,{className:"btn btn-primary",type:"submit"},"Send"))))))},W=function(t){var e=t.user,n=t.group;return r.a.createElement(p.b,{mutation:z},function(t){return r.a.createElement(P,{createGroupChatEntry:t,user:e,group:n})})};function _(){var t=Object(d.a)(["\n\tquery allGroupChatEntries($groupId: ID!) {\n\t\tallGroupChatEntries(filter: { group: { id: $groupId } }) {\n\t\t\tfrom {\n\t\t\t\tname\n\t\t\t\tid\n\t\t\t}\n\t\t\tid\n\t\t\tcontent\n\t\t\tedited\n\t\t\tdeleted\n\t\t\tcreatedAt\n\t\t}\n\t}\n"]);return _=function(){return t},t}var H=U()(_()),M=function(t){var e=t.data.allGroupChatEntries,n=void 0===e?[]:e;return r.a.createElement("ul",null,n.map(function(t){return r.a.createElement("li",{key:t.id},JSON.stringify(t))}))},R=function(t){t.user;var e=t.group;console.log({group:e});var n=Object(a.useState)(!1),o=Object(m.a)(n,2),l=o[0],c=o[1];return r.a.createElement(p.c,{query:H,fetchPolicy:"network-only",variables:{groupId:e.id,refresh:l}},function(t){var e=t.data;return r.a.createElement(r.a.Fragment,null,r.a.createElement(M,{data:e}),r.a.createElement("button",{onClick:function(){return c(!l)}},"Manual refresh chat entries - click to see last chat ",l))})},T=function(t){var e=t.user,n=t.group,a=t.handleLogout;return console.log(e),r.a.createElement("div",{className:"app-layout"},r.a.createElement("div",{className:"channels box"},r.a.createElement("div",null," List channels "),r.a.createElement(J,{group:n})),r.a.createElement("div",{className:"header"},JSON.stringify(e)," ",r.a.createElement("button",{onClick:a},"Logout")),r.a.createElement("div",{className:"messages box scroll-container"},r.a.createElement(R,{group:n})),r.a.createElement("div",{className:"input box"},r.a.createElement(W,{user:e,group:n})))};n(178);function Y(){var t=Object(d.a)(["\n\tmutation login($email: String!, $password: String!) {\n\t\tsigninUser(email: { email: $email, password: $password }) {\n\t\t\ttoken\n\t\t\tuser {\n\t\t\t\tid\n\t\t\t\tname\n\t\t\t\temail\n\t\t\t}\n\t\t}\n\t}\n"]);return Y=function(){return t},t}function K(){var t=Object(d.a)(["\n\tmutation createUserAndSignOn($name: String!, $email: String!, $password: String!) {\n\t\tcreateUser(name: $name, authProvider: { email: { email: $email, password: $password } }) {\n\t\t\tid\n\t\t}\n\t\tsigninUser(email: { email: $email, password: $password }) {\n\t\t\ttoken\n\t\t\tuser {\n\t\t\t\tid\n\t\t\t\tname\n\t\t\t\temail\n\t\t\t}\n\t\t}\n\t}\n"]);return K=function(){return t},t}var Q=U()(K()),V=U()(Y()),X=function(){var t=Object(a.useState)(),e=Object(m.a)(t,2),n=e[0],o=e[1],l=Object(a.useState)(),c=Object(m.a)(l,2),d=c[0],g=c[1],v=function(){var t=Object(s.a)(i.a.mark(function t(e){var n,a,r,l,c,s,m,d,p,v,f;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.name,a=e.email,r=e.password,g(null),o(null),t.prev=3,t.next=6,$.mutate({mutation:""===n?V:Q,variables:{name:n,email:a,password:r}});case 6:l=t.sent,c=l.data,s=(void 0===c?{}:c).signinUser,d=(m=void 0===s?{}:s).token,p=void 0===d?"":d,v=Object(u.a)(m,["token"]),f=v.user,j(p),o(f),t.next=18;break;case 15:t.prev=15,t.t0=t.catch(3),g(t.t0.message);case 18:case"end":return t.stop()}},t,null,[[3,15]])}));return function(e){return t.apply(this,arguments)}}();return r.a.createElement(p.a,{client:$},r.a.createElement(r.a.Fragment,null,n?r.a.createElement(T,{user:n,group:{name:"General",id:"cjtxbbp3yglac0183o1oovog7"},handleLogout:function(){o(void 0),j({token:null}),$.resetStore()}}):r.a.createElement(L,{handleLogin:v}),d&&r.a.createElement("div",null,d)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(X,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})},96:function(t,e,n){t.exports=n(180)}},[[96,1,2]]]);
//# sourceMappingURL=main.b4850ab6.chunk.js.map